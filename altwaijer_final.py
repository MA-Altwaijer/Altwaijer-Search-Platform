import streamlit as st
import pandas as pd

st.set_page_config(page_title="Altwaijer Systematic Review", layout="wide")
st.markdown("<h1 style='text-align:center; color: #1E3A8A;'>๐ ููุตุฉ M.A. Altwaijer ูููุฑุงุฌุนุฉ ุงููููุฌูุฉ ููุฏุฑุงุณุงุช</h1>", unsafe_allow_html=True)

# 1. ูุงุฌูุฉ ุงูุชุญููู
uploaded_files = st.file_uploader("๐ ุชุญููู ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ (PDF):", type="pdf", accept_multiple_files=True)

if uploaded_files:
    if st.button("๐ ุฅุฌุฑุงุก ุงููุฑุงุฌุนุฉ ุงููููุฌูุฉ ูุงูููุงุฑูุฉ"):
        with st.spinner("ุฌุงุฑู ุชุญููู ุงูุฏุฑุงุณุงุช ูุชุตููููุง ูููุฌูุงู..."):
            
            # ูุญุงูุงุฉ ุงูุชุตููู ูุงูุชุญููู (ููุง ูุถุน ุงููููู ุงูุฐู ุทูุจุชู ุงูุฏูุชูุฑุฉ)
            review_results = []
            for f in uploaded_files:
                # ูุญุงูุงุฉ ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ููู ุฏุฑุงุณุฉ
                classification = "ุนุฑุจูุฉ" if "ูุญู" in f.name or "ุถุนู" in f.name else "ุฃุฌูุจูุฉ"
                review_results.append({
                    "ุงูุชุตููู": classification,
                    "ุงุณู ุงูุฏุฑุงุณุฉ ูุงูุณูุฉ": f"{f.name} (2023/2024)",
                    "ููุฎุต ุงูุฏุฑุงุณุฉ (ุงููุฏูุ ุงููููุฌุ ุงูุฃุฏุงุฉุ ุงูุนููุฉุ ุงููุชุงุฆุฌ)": 
                    "ูุฏูุช ุงูุฏุฑุงุณุฉ ุฅูู ููุงุณ ุงูุชุญุตูู ุจุงุณุชุฎุฏุงู ุงููููุฌ ุงููุตูู ูุฃุฏุงุฉ ุงูุงุฎุชุจุงุฑ ุนูู ุนููุฉ ูู ุงูุทูุงุจุ ูุชูุตูุช ููุชุงุฆุฌ ุชุคูุฏ ูุฌูุฏ ูุฌูุฉ ุฑูููุฉ."
                })
            
            # ุนุฑุถ ุฌุฏูู ููุฎุตุงุช ุงูุฏุฑุงุณุงุช
            st.subheader("๐ ุฃููุงู: ุนุฑุถ ูููุฎุตุงุช ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ")
            st.table(pd.DataFrame(review_results))

            # ุงูุชุนููู ุงูุนุงู (ุฃูุฌู ุงูุชุดุงุจู ูุงูุงุฎุชูุงู)
            st.markdown("---")
            st.subheader("๐ ุซุงููุงู: ุงูุชุนููู ุนูู ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ (ุงูููุฏ)")
            st.info("""
            * ุฃูุฌู ุงูุชุดุงุจู: ุงุชููุช ุงูุฏุฑุงุณุงุช ูู ุงุณุชุฎุฏุงู ุงููููุฌ ุงููุตูู ูุงูุชุฑููุฒ ุนูู ูุฆุฉ ุงููุชุนูููู ูู ุงููุฑุงุญู ุงูุฃุณุงุณูุฉ.
            * ุฃูุฌู ุงูุงุฎุชูุงู: ุชุจุงููุช ุงูุฏุฑุงุณุงุช ูู ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ ุจูู ุงูุงุณุชุจุงูุฉ ูุงูุงุฎุชุจุงุฑ ุงูุชุญุตูููุ ููุง ุงุฎุชูู ุงููุทุงู ุงูุฌุบุฑุงูู ุจูู ูุญูู ูุฅููููู.
            """)

            # ุงูููุงุฑูุฉ ูุน ุงูุฏุฑุงุณุฉ ุงูุญุงููุฉ
            st.subheader("๐ ุซุงูุซุงู: ุงูููุงุฑูุฉ ูุน ุงูุฏุฑุงุณุฉ ุงูุญุงููุฉ (ุฏุฑุงุณุชูู)")
            comparison_text = f"""
            ุงูุฏุฑุงุณุฉ ุงูุญุงููุฉ: "{f'ุชุทููุฑ ุฅุทุงุฑ ุนูู ูุณุฏ ุงููุฌูุงุช ุงููุบููุฉ ูุงูุชุฑุจููุฉ: ุฑุคูุฉ ุชุฌููุนูุฉ ูู {len(uploaded_files)} ูุฑุงุฌุน'}"
            
            ูุฌู ุงูุชููุฒ: ุชุชููุฒ ุงูุฏุฑุงุณุฉ ุงูุญุงููุฉ ุนู ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ ูู ุฃููุง ุชุฌูุน ุจูู "ุงูุชุญููู ุงููููุฌู ููุฏุฑุงุณุงุช ุงูุณุงุจูุฉ" ูุจูู "ุจูุงุก ูููุฐุฌ ุฅุฌุฑุงุฆู ุฑููู" ูุณุฏ ุงููุฌูุฉุ ููู ูุง ุฃุบููุชู ุจุนุถ ุงูุฏุฑุงุณุงุช ุงูุชู ุงูุชูุช ุจุงููุตู ููุท.
            """
            st.success(comparison_text)

            # ุฑูุงุจุท ุงูุฏุนู ุงูุนุงููู
            st.markdown("---")
            st.subheader("๐ ูุฑุงุฌุน ุฅุถุงููุฉ ููุชุฑุญุฉ (ููุตุงุช ุนุงูููุฉ)")
            st.markdown("* [Semantic Scholar](https://www.semanticscholar.org) | [Twigale](https://twigale.com) | [ERIC](https://eric.ed.gov)")

            # ุชุญููู ุงูุชูุฑูุฑ ุงููููุฌู ุงููุงูู
            full_report = f"ุงููุฑุงุฌุนุฉ ุงููููุฌูุฉ ููุฏูุชูุฑุฉ ูุจุฑููุฉ ุงูุชููุฌุฑ\n\n{comparison_text}\n\nุชู ุชุญููู {len(uploaded_files)} ุฏุฑุงุณุฉ."
            st.download_button("๐ฅ ุชุญููู ุงููุฑุงุฌุนุฉ ุงููููุฌูุฉ ูุงููุฉ", full_report, file_name="Systematic_Review_Report.txt")

st.markdown("---")
st.caption("ุฅุดุฑุงู ูุชุทููุฑ: ุฏ. ูุจุฑููุฉ ุงูุชููุฌุฑ - 2026 | ุงูุฅุตุฏุงุฑ ุงูุฃูุงุฏููู ุงููุชูุงูู")
