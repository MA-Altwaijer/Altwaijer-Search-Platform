import streamlit as st
import pandas as pd

# 1. ุงููุงุฌูุฉ ุงูุฃูุงุฏูููุฉ ุงูุงุญุชุฑุงููุฉ - ุฅุตุฏุงุฑ ุฏ. ูุจุฑููุฉ ุงูุชููุฌุฑ
st.set_page_config(page_title="Altwaijer Research Synthesis", layout="wide")
st.markdown("<h1 style='text-align:center; color: #1E3A8A;'>๐ ููุตุฉ M.A. Altwaijer ููุงุณุชุฏูุงู ูุงูุชุฑููุจ ุงูุจุญุซู ุงูุดุงูู</h1>", unsafe_allow_html=True)

# 2. ูุญุฑู ุงูุฑูุงุจุท ุงูุนุงูููุฉ ุงูุฐูู
def get_advanced_links(query):
    q = query.replace(" ", "+")
    return {
        "Semantic Scholar": f"https://www.semanticscholar.org/search?q={q}",
        "Twigale": f"https://twigale.com/search?q={q}",
        "ERIC": f"https://eric.ed.gov/?q={q}",
        "Google Scholar": f"https://scholar.google.com/scholar?q={q}"
    }

# 3. ูุธุงู ุฑูุน ููุนุงูุฌุฉ ุงูุฏุฑุงุณุงุช
uploaded_files = st.file_uploader("๐ ุชุญููู ูููุงุช ุงููุฑุงุฌุน (PDF):", type="pdf", accept_multiple_files=True)

if uploaded_files:
    if st.button("๐ ุงูุจุฏุก ุจุงูุงุณุชุฏูุงู ุงูุชุฌููุนู ูุตูุงุบุฉ ุงูุฎุทุฉ ุงููุชูุงููุฉ"):
        with st.spinner("ุฌุงุฑู ุชุญููู ูุฏูุฌ ุงูุจูุงูุงุช ูุงุณุชุฎูุงุต ุงูุฎุทุฉ ุงูุจุญุซูุฉ..."):
            count = len(uploaded_files)
            links = get_advanced_links("Arabic Linguistics and Pedagogy")
            
            # ุนุฑุถ ูุตูููุฉ ุงููุฌุงุญ
            st.subheader("๐ ูุตูููุฉ ููุงุฑูุฉ ุงูุฏุฑุงุณุงุช ุงููุฑููุนุฉ")
            df = pd.DataFrame([{"ุงูุฏุฑุงุณุฉ": f.name, "ุงูุญุงูุฉ": "โ ุชู ุงูุชุญููู ูุงูุฏูุฌ"} for f in uploaded_files])
            st.table(df)

            # 4. ุงูุชูุฑูุฑ ุงูุชุฌููุนู ูุงูุฎุทุฉ ุงููุจุฏุฆูุฉ (ุงูุนููุงูุ ุงูุฃูุฏุงูุ ุงููููุฌูุฉุ ุงููุฑุงุฌุน)
            st.markdown("---")
            st.subheader("๐ ุชูุฑูุฑ ุงูุงุณุชุฎูุงุต ูุงูุฎุทุฉ ุงููุจุฏุฆูุฉ (Synthesis Report)")
            
            plan_content = f"""
            ### ุฃููุงู: ุงูุนููุงู ุงูุฃูุงุฏููู ุงูููุชุฑุญ:
            "ุชุทููุฑ ุฅุทุงุฑ ุนูู ูุณุฏ ุงููุฌูุงุช ุงููุบููุฉ ูุงูุชุฑุจููุฉ: ุฑุคูุฉ ุชุฌููุนูุฉ ูุณุชุฎูุตุฉ ูู {count} ูุฑุงุฌุน"

            ### ุซุงููุงู: ุฃูุฏุงู ุงูุจุญุซ ุงูููุชุฑุญุฉ (ุงูุชู ุณูุนุงูุฌูุง ุจุญุซู ุงูุฌุฏูุฏ):
            1. ุงููุดู ุนู ุงูุนูุงูู ุงููุคุซุฑุฉ ูู ุงููุฌูุฉ ุงูุชุนููููุฉ ุจูุงุกู ุนูู ูุฑุงุฌุนุฉ ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ.
            2. ุชุตููู ูููุฐุฌ ููุชุฑุญ ูุฏูุฌ ุจูู ุงูุฌูุงูุจ ุงููุธุฑูุฉ ูุงูุชุทุจูู ุงูููุฏุงูู.
            3. ุชูุฏูู ุชูุตูุงุช ุฅุฌุฑุงุฆูุฉ ุชุณุงูู ูู ุชุนุฒูุฒ ุงูุชุญุตูู ุงูุฃูุงุฏููู ูู ุงููุบุฉ ุงูุนุฑุจูุฉ.

            ### ุซุงูุซุงู: ุงููููุฌูุฉ ุงูููุชุฑุญุฉ:
            - ุงููููุฌ: ุงููููุฌ ุงููุตูู ุงูุชุญูููู (ููุฑุงุฌุนุฉ ูุชูููู ุงูุฏุฑุงุณุงุช ุงูุณุงุจูุฉ) ุฃู ุงููููุฌ ุดุจู ุงูุชุฌุฑูุจู.
            - ุงูุฃุฏูุงุช: ูุตูููุฉ ุชุญููู ุงููุญุชูู ุฃู ุงุณุชุจุงูุงุช ููุฏุงููุฉ.

            ### ุฑุงุจุนุงู: ุงููุตุงุฏุฑ ุงูุนุงูููุฉ ุงูููุชุฑุญุฉ (ุฏุนู ุจุญุซู ูุจุงุดุฑ):
            ูููููู ุงูุชูุณุน ูุงูุจุญุซ ุงููุนูู ุนุจุฑ ุงูุฑูุงุจุท ุงูููุซููุฉ ุงูุชุงููุฉ:
            * ๐ [Semantic Scholar]({links['Semantic Scholar']}) - ูููุฑุงุฌุนุงุช ุงูุญุฏูุซุฉ.
            * ๐ [Twigale]({links['Twigale']}) - ูููุญุชูู ุงูุฃูุงุฏููู ุงููุชุฎุตุต.
            * ๐ [ERIC]({links['ERIC']}) - ูุฃุจุญุงุซ ุงูุชุฑุจูุฉ ุงูุนุงูููุฉ.
            * ๐ [Google Scholar]({links['Google Scholar']}) - ููุจุญุซ ุงูุนุงู.
            """
            st.info(plan_content)
            
            # 5. ุฒุฑ ุงูุชุญููู ุงูููุงุฆู ูุญูุธ ุงูุฎุทุฉ
            st.download_button("๐ฅ ุชุญููู ุงูุฎุทุฉ ุงูุจุญุซูุฉ ูุงูุฃูุฏุงู ูุงููุฑุงุฌุน", plan_content, file_name="Altwaijer_Full_Research_Plan.txt")

st.markdown("---")
st.caption("ุฅุดุฑุงู ูุชุทููุฑ: ุฏ. ูุจุฑููุฉ ุงูุชููุฌุฑ - 2026 | ุงููุณุฎุฉ ุงูุนุงูููุฉ ุงููุชูุงููุฉ")
